[
  {
    "role": "system",
    "content": "Critic. You are a helpful assistant highly skilled in evaluating the quality of a given python code by providing a score from 1 (bad) - 10 (good) while providing clear rationale. YOU MUST CONSIDER CODING BEST PRACTICES for each evaluation. Specifically, you can carefully evaluate the code across the following dimensions\n- bugs (bugs):  are there bugs, logic errors, syntax error or typos? Are there any reasons why the code may fail to compile? How should it be fixed? If ANY bug exists, the bug score MUST be less than 5.\n- Goal compliance (compliance): how well the source Cobol code was converted?\n\nYOU MUST PROVIDE A SCORE for each of the above dimensions.\n{bugs: 0, transformation: 0, compliance: 0, aesthetics: 0}\nDo not suggest code. \nFinally, based on the critique above, suggest a concrete list of actions that the coder should take to improve the code.    \n"
  },
  {
    "role": "user",
    "content": "Source Cobol code can be found between the delimiters === COBOL START === and === COBOL END ===.\nConverted Python code can be found between the delimiters === PYTHON START === and === PYTHON END ===.\n\n=== COBOL START ===\n IDENTIFICATION DIVISION.\n PROGRAM-ID.  PINVRPT.\n ENVIRONMENT DIVISION.\n INPUT-OUTPUT SECTION.\n FILE-CONTROL.\n     SELECT INALL ASSIGN TO PINV.\n     SELECT INACT ASSIGN TO PACT.\n     SELECT INSPN ASSIGN TO PSPN.\n     SELECT INDES ASSIGN TO PDES.\n     SELECT RPTALL ASSIGN TO RPTALL.\n     SELECT RPTACT ASSIGN TO RPTACT.\n     SELECT RPTSPN ASSIGN TO RPTSPN.\n     SELECT RPTDES ASSIGN TO RPTDES.\n DATA DIVISION.\n FILE SECTION.\n FD INALL\n     RECORDING MODE F.\n 01  INALL-RECORD-ALL.\n     05  GRAIN-SERIAL-ALL             PIC 9(12).\n     05  GRAIN-TYPE-ALL               PIC X(10).\n     05  GRAIN-FORMULA-ALL            PIC X(15).\n     05  GRAIN-STATUS-ALL             PIC X(1).\n     05  GRAIN-QA-ALL                 PIC X(4).\n     05  GRAIN-QUALITY-ALL            PIC 9(2).\n     05  FILLER                       PIC 9(10).\n     05  FILLER                       PIC 9(10).\n     05  GRAIN-WEIGHT-ALL             PIC 9(10).\n     05  FILLER                       PIC X(375).\n FD INACT\n     RECORDING MODE F.\n 01  INALL-RECORD-ACT.\n     05  GRAIN-SERIAL-ACT             PIC 9(12).\n     05  GRAIN-TYPE-ACT               PIC X(10).\n     05  GRAIN-FORMULA-ACT            PIC X(15).\n     05  GRAIN-STATUS-ACT             PIC X(1).\n     05  GRAIN-QA-ACT                 PIC X(4).\n     05  GRAIN-QUALITY-ACT            PIC 9(2).\n     05  FILLER                       PIC 9(10).\n     05  FILLER                       PIC 9(10).\n     05  GRAIN-WEIGHT-ACT             PIC 9(10).\n     05  FILLER                       PIC X(375).\n FD INSPN\n     RECORDING MODE F.\n 01  INALL-RECORD-SPN.\n     05  GRAIN-SERIAL-SPN             PIC 9(12).\n     05  GRAIN-TYPE-SPN               PIC X(10).\n     05  GRAIN-FORMULA-SPN            PIC X(15).\n     05  GRAIN-STATUS-SPN             PIC X(1).\n     05  GRAIN-QA-SPN                 PIC X(4).\n     05  GRAIN-QUALITY-SPN            PIC 9(2).\n     05  FILLER                       PIC 9(10).\n     05  FILLER                       PIC 9(10).\n     05  GRAIN-WEIGHT-SPN             PIC 9(10).\n     05  FILLER                       PIC X(375).\n FD INDES\n     RECORDING MODE F.\n 01  INALL-RECORD-DES.\n     05  GRAIN-SERIAL-DES             PIC 9(12).\n     05  GRAIN-TYPE-DES               PIC X(10).\n     05  GRAIN-FORMULA-DES            PIC X(15).\n     05  GRAIN-STATUS-DES             PIC X(1).\n     05  GRAIN-QA-DES                 PIC X(4).\n     05  GRAIN-QUALITY-DES            PIC 9(2).\n     05  FILLER                       PIC 9(10).\n     05  FILLER                       PIC 9(10).\n     05  GRAIN-WEIGHT-DES             PIC 9(10).\n     05  FILLER                       PIC X(375).\n FD RPTALL\n     RECORDING MODE V.\n 01  OUTFILE-ALL                 PIC X(200).\n FD RPTACT\n     RECORDING MODE V.\n 01  OUTFILE-ACTIVE              PIC X(200).\n FD RPTSPN\n     RECORDING MODE V.\n 01  OUTFILE-SPENT               PIC X(200).\n FD RPTDES\n     RECORDING MODE V.\n 01  OUTFILE-DESTROYED           PIC X(200).\n WORKING-STORAGE SECTION.\n 01  WS-CURRENT-DATE.\n     05  WS-YEAR                 PIC 9(4).\n     05  WS-MONTH                PIC 9(2).\n     05  WS-DAY                  PIC 9(2).\n     05  WS-HOURS                PIC 9(2).\n     05  WS-MINUTES              PIC 9(2).\n     05  WS-SECONDS              PIC 9(2).\n     05  WS-HUND-SECOND          PIC 9(2).\n     05  WS-GMT                  PIC X(5).\n 01  OUT-RECORD.\n     05  SERIAL-OUT              PIC X(12).\n     05  FILLER                  PIC X(2)\n         VALUE  SPACES.\n     05  STATUS-OUT              PIC X(10).\n     05  FILLER                  PIC X(2)\n         VALUE SPACES.\n     05  TYPE-OUT                PIC X(10).\n     05  FILLER                  PIC X(2)\n         VALUE  SPACES.\n     05  FORMULA-OUT             PIC X(15).\n     05  FILLER                  PIC X(2)\n         VALUE SPACES.\n     05  QA-OUT                  PIC X(4).\n     05  FILLER                  PIC X(2)\n         VALUE SPACES.\n     05  WEIGHT-OUT              PIC X(10).\n     05  FILLER                  PIC X\n         VALUE 'G'.\n 01  DATE-LINE.\n     05  FILLER                  PIC X(12)\n         VALUE 'REPORT DATE:'.\n     05  FILLER                  PIC X(1)\n         VALUE SPACES.\n     05  DT-YEAR                 PIC 9(4).\n     05  FILLER                  PIC X\n         VALUE '/'.\n     05  DT-MONTH                PIC 9(2).\n     05  FILLER                  PIC X\n         VALUE '/'.\n     05  DT-DAY                  PIC 9(2).\n 01  HEADER-1.\n     05  FILLER                  PIC X(100)\n         VALUE  'HAYNIE RESEARCH & DEVELOPMENT'.\n 01  HEADER-ALL.\n     05  FILLER                  PIC X(100)\n         VALUE  'PROPELLANT GRAIN INVENTORY REPORT - ALL'.\n 01  HEADER-ACTIVE.\n     05  FILLER                  PIC X(100)\n         VALUE  'PROPELLANT GRAIN INVENTORY REPORT - ACTIVE'.\n 01  HEADER-SPENT.\n     05  FILLER                  PIC X(100)\n         VALUE  'PROPELLANT GRAIN INVENTORY REPORT - SPENT'.\n 01  HEADER-DESTROYED.\n     05  FILLER                  PIC X(100)\n         VALUE  'PROPELLANT GRAIN INVENTORY REPORT - DESTROYED'.\n 01  HEADER-3.\n     05  FILLER                  PIC X(14)\n         VALUE  'SERIAL'.\n     05  FILLER                  PIC X(12)\n         VALUE  'STATUS'.\n     05  FILLER                  PIC X(12)\n         VALUE  'TYPE'.\n     05  FILLER                  PIC X(17)\n         VALUE  'FORMULA'.\n     05  FILLER                  PIC X(6)\n         VALUE  'QA'.\n     05  FILLER                  PIC X(11)\n         VALUE  'WEIGHT'.\n 01  HEADER-4.\n     05  FILLER                  PIC X(12)\n         VALUE  '------------'.\n     05  FILLER                  PIC X(2)\n         VALUE SPACES.\n     05  FILLER                  PIC X(10)\n         VALUE  '----------'.\n     05  FILLER                  PIC X(2)\n         VALUE SPACES.\n     05  FILLER                  PIC X(10)\n         VALUE '----------'.\n     05  FILLER                  PIC X(2)\n         VALUE SPACES.\n     05  FILLER                  PIC X(15)\n         VALUE '---------------'.\n     05  FILLER                  PIC X(2)\n         VALUE SPACES.\n     05  FILLER                  PIC X(4)\n         VALUE '----'.\n     05  FILLER                  PIC X(2)\n         VALUE SPACES.\n     05  FILLER                  PIC X(11)\n         VALUE '-----------'.\n 01  SWITCHES.\n     05  INALL-EOF-SWITCH         PIC X(1) VALUE 'N'.\n     05  INACT-EOF-SWITCH         PIC X(1) VALUE 'N'.\n     05  INSPN-EOF-SWITCH         PIC X(1) VALUE 'N'.\n     05  INDES-EOF-SWITCH         PIC X(1) VALUE 'N'.\n PROCEDURE DIVISION.\n MAIN-PROGRAM.\n     MOVE FUNCTION CURRENT-DATE TO WS-CURRENT-DATE.\n     MOVE WS-YEAR TO DT-YEAR.\n     MOVE WS-MONTH TO DT-MONTH.\n     MOVE WS-DAY TO DT-DAY.\n     PERFORM REPORT-ALL.\n     PERFORM REPORT-ACTIVE.\n     PERFORM REPORT-SPENT.\n     PERFORM REPORT-DESTROYED.\n     STOP RUN.\n REPORT-ALL.\n     OPEN INPUT INALL\n          OUTPUT RPTALL.\n     READ INALL\n         AT END\n             MOVE 'Y' TO INALL-EOF-SWITCH\n     END-READ.\n     MOVE HEADER-1 TO OUTFILE-ALL.\n     WRITE OUTFILE-ALL.\n     MOVE HEADER-ALL TO OUTFILE-ALL.\n     WRITE OUTFILE-ALL.\n     MOVE DATE-LINE TO OUTFILE-ALL.\n     WRITE OUTFILE-ALL.\n     MOVE SPACES TO OUTFILE-ALL.\n     WRITE OUTFILE-ALL.\n     MOVE HEADER-3 TO OUTFILE-ALL.\n     WRITE OUTFILE-ALL.\n     MOVE HEADER-4 TO OUTFILE-ALL.\n     WRITE OUTFILE-ALL.\n     PERFORM ALL-LOOP\n         UNTIL INALL-EOF-SWITCH = 'Y'.\n     CLOSE INALL\n           RPTALL.\n REPORT-ACTIVE.\n     OPEN INPUT INACT\n          OUTPUT RPTACT.\n     READ INACT\n         AT END\n             MOVE 'Y' TO INACT-EOF-SWITCH\n     END-READ.\n     MOVE HEADER-1 TO OUTFILE-ACTIVE.\n     WRITE OUTFILE-ACTIVE.\n     MOVE HEADER-ACTIVE TO OUTFILE-ACTIVE.\n     WRITE OUTFILE-ACTIVE.\n     MOVE DATE-LINE TO OUTFILE-ACTIVE.\n     WRITE OUTFILE-ACTIVE.\n     MOVE SPACES TO OUTFILE-ACTIVE.\n     WRITE OUTFILE-ACTIVE.\n     MOVE HEADER-3 TO OUTFILE-ACTIVE.\n     WRITE OUTFILE-ACTIVE.\n     MOVE HEADER-4 TO OUTFILE-ACTIVE.\n     WRITE OUTFILE-ACTIVE.\n     PERFORM ACTIVE-LOOP\n         UNTIL INACT-EOF-SWITCH = 'Y'.\n     CLOSE INACT\n           RPTACT.\n REPORT-SPENT.\n     OPEN INPUT INSPN\n          OUTPUT RPTSPN.\n     READ INSPN\n         AT END\n             MOVE 'Y' TO INSPN-EOF-SWITCH\n     END-READ.\n     MOVE HEADER-1 TO OUTFILE-SPENT.\n     WRITE OUTFILE-SPENT.\n     MOVE HEADER-SPENT TO OUTFILE-SPENT.\n     WRITE OUTFILE-SPENT.\n     MOVE DATE-LINE TO OUTFILE-SPENT.\n     WRITE OUTFILE-SPENT.\n     MOVE SPACES TO OUTFILE-SPENT.\n     WRITE OUTFILE-SPENT.\n     MOVE HEADER-3 TO OUTFILE-SPENT.\n     WRITE OUTFILE-SPENT.\n     MOVE HEADER-4 TO OUTFILE-SPENT.\n     WRITE OUTFILE-SPENT.\n     PERFORM SPENT-LOOP\n         UNTIL INSPN-EOF-SWITCH = 'Y'.\n     CLOSE INSPN\n           RPTSPN.\n REPORT-DESTROYED.\n     OPEN INPUT INDES\n          OUTPUT RPTDES.\n     READ INDES\n         AT END\n             MOVE 'Y' TO INDES-EOF-SWITCH\n     END-READ.\n     MOVE HEADER-1 TO OUTFILE-DESTROYED.\n     WRITE OUTFILE-DESTROYED.\n     MOVE HEADER-DESTROYED TO OUTFILE-DESTROYED.\n     WRITE OUTFILE-DESTROYED.\n     MOVE DATE-LINE TO OUTFILE-DESTROYED.\n     WRITE OUTFILE-DESTROYED.\n     MOVE SPACES TO OUTFILE-DESTROYED.\n     WRITE OUTFILE-DESTROYED.\n     MOVE HEADER-3 TO OUTFILE-DESTROYED.\n     WRITE OUTFILE-DESTROYED.\n     MOVE HEADER-4 TO OUTFILE-DESTROYED.\n     WRITE OUTFILE-DESTROYED.\n     PERFORM DESTROYED-LOOP\n         UNTIL INDES-EOF-SWITCH = 'Y'.\n     CLOSE INDES\n           RPTDES.\n ALL-LOOP.\n     MOVE GRAIN-SERIAL-ALL TO SERIAL-OUT.\n     IF GRAIN-STATUS-ALL = 0\n         MOVE \"ACTIVE\" TO STATUS-OUT\n     ELSE IF GRAIN-STATUS-ALL = 1\n         MOVE \"SPENT\" TO STATUS-OUT\n     ELSE IF GRAIN-STATUS-ALL = 3\n         MOVE \"DESTROYED\" TO STATUS-OUT\n     ELSE\n         MOVE \"OTHER\" TO STATUS-OUT\n     END-IF.\n     MOVE GRAIN-TYPE-ALL TO TYPE-OUT.\n     MOVE GRAIN-FORMULA-ALL TO FORMULA-OUT.\n     MOVE GRAIN-QA-ALL TO QA-OUT.\n     MOVE GRAIN-WEIGHT-ALL TO WEIGHT-OUT.\n     MOVE OUT-RECORD TO OUTFILE-ALL.\n     WRITE OUTFILE-ALL.\n     READ INALL\n         AT END\n             MOVE 'Y' TO INALL-EOF-SWITCH\n     END-READ.\n ACTIVE-LOOP.\n     MOVE GRAIN-SERIAL-ACT TO SERIAL-OUT.\n     IF GRAIN-STATUS-ACT = 0\n         MOVE \"ACTIVE\" TO STATUS-OUT\n     ELSE IF GRAIN-STATUS-ACT = 1\n         MOVE \"SPENT\" TO STATUS-OUT\n     ELSE IF GRAIN-STATUS-ACT = 3\n         MOVE \"DESTROYED\" TO STATUS-OUT\n     ELSE\n         MOVE \"OTHER\" TO STATUS-OUT\n     END-IF.\n     MOVE GRAIN-TYPE-ACT TO TYPE-OUT.\n     MOVE GRAIN-FORMULA-ACT TO FORMULA-OUT.\n     MOVE GRAIN-QA-ACT TO QA-OUT.\n     MOVE GRAIN-WEIGHT-ACT TO WEIGHT-OUT.\n     MOVE OUT-RECORD TO OUTFILE-ACTIVE.\n     WRITE OUTFILE-ACTIVE.\n     READ INACT\n         AT END\n             MOVE 'Y' TO INACT-EOF-SWITCH\n     END-READ.\n SPENT-LOOP.\n     MOVE GRAIN-SERIAL-SPN TO SERIAL-OUT.\n     IF GRAIN-STATUS-SPN = 0\n         MOVE \"ACTIVE\" TO STATUS-OUT\n     ELSE IF GRAIN-STATUS-SPN = 1\n         MOVE \"SPENT\" TO STATUS-OUT\n     ELSE IF GRAIN-STATUS-SPN = 3\n         MOVE \"DESTROYED\" TO STATUS-OUT\n     ELSE\n         MOVE \"OTHER\" TO STATUS-OUT\n     END-IF.\n     MOVE GRAIN-TYPE-SPN TO TYPE-OUT.\n     MOVE GRAIN-FORMULA-SPN TO FORMULA-OUT.\n     MOVE GRAIN-QA-SPN TO QA-OUT.\n     MOVE GRAIN-WEIGHT-SPN TO WEIGHT-OUT.\n     MOVE OUT-RECORD TO OUTFILE-SPENT.\n     WRITE OUTFILE-SPENT.\n     READ INSPN\n         AT END\n             MOVE 'Y' TO INSPN-EOF-SWITCH\n     END-READ.\n DESTROYED-LOOP.\n     MOVE GRAIN-SERIAL-DES TO SERIAL-OUT.\n     IF GRAIN-STATUS-DES = 0\n         MOVE \"ACTIVE\" TO STATUS-OUT\n     ELSE IF GRAIN-STATUS-DES = 1\n         MOVE \"SPENT\" TO STATUS-OUT\n     ELSE IF GRAIN-STATUS-DES = 3\n         MOVE \"DESTROYED\" TO STATUS-OUT\n     ELSE\n         MOVE \"OTHER\" TO STATUS-OUT\n     END-IF.\n     MOVE GRAIN-TYPE-DES TO TYPE-OUT.\n     MOVE GRAIN-FORMULA-DES TO FORMULA-OUT.\n     MOVE GRAIN-QA-DES TO QA-OUT.\n     MOVE GRAIN-WEIGHT-DES TO WEIGHT-OUT.\n     MOVE OUT-RECORD TO OUTFILE-DESTROYED.\n     WRITE OUTFILE-DESTROYED.\n     READ INDES\n         AT END\n             MOVE 'Y' TO INDES-EOF-SWITCH\n     END-READ.\n=== COBOL END ===\n\n=== PYTHON START ===\nimport datetime\n\ndef read_record(file, start, length):\n    file.seek(start)\n    return file.read(length).strip()\n\ndef write_report(file, record):\n    file.write(record + '\\n')\n\ndef process_file(input_file, output_file, report_header):\n    input_file.seek(0)\n    output_file.write(report_header + '\\n')\n    output_file.write('REPORT DATE: ' + str(datetime.datetime.now().date()) + '\\n\\n')\n    output_file.write('SERIAL    STATUS    TYPE    FORMULA    QA    WEIGHT\\n')\n    output_file.write('------------  ----------  ----------  ---------------  ----  -----------\\n')\n\n    eof = False\n    while not eof:\n        serial = read_record(input_file, 0, 12)\n        status = read_record(input_file, 22, 1)\n        if status == '0':\n            status = 'ACTIVE'\n        elif status == '1':\n            status = 'SPENT'\n        elif status == '3':\n            status = 'DESTROYED'\n        else:\n            status = 'OTHER'\n        type = read_record(input_file, 12, 10)\n        formula = read_record(input_file, 32, 15)\n        qa = read_record(input_file, 47, 4)\n        weight = read_record(input_file, 71, 10)\n        record = f'{serial}  {status}  {type}  {formula}  {qa}  {weight}'\n        write_report(output_file, record)\n        eof = len(input_file.readline()) == 0\n\ndef main():\n    with open('PINV', 'r') as inall, open('RPTALL', 'w') as rptall:\n        process_file(inall, rptall, 'PROPELLANT GRAIN INVENTORY REPORT - ALL')\n    with open('PACT', 'r') as inact, open('RPTACT', 'w') as rptact:\n        process_file(inact, rptact, 'PROPELLANT GRAIN INVENTORY REPORT - ACTIVE')\n    with open('PSPN', 'r') as inspn, open('RPTSPN', 'w') as rptspn:\n        process_file(inspn, rptspn, 'PROPELLANT GRAIN INVENTORY REPORT - SPENT')\n    with open('PDES', 'r') as indes, open('RPTDES', 'w') as rptdes:\n        process_file(indes, rptdes, 'PROPELLANT GRAIN INVENTORY REPORT - DESTROYED')\n\nif __name__ == '__main__':\n    main()\n\n=== PYTHON END ==="
  }
]